<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>TrunkBasedWorkshop</title>

    <link rel="stylesheet" href="./reveal.js/dist/reset.css" />
    <link rel="stylesheet" href="./reveal.js/dist/reveal.css" />
    <link rel="stylesheet" href="./reveal.js/dist/theme/solarized.css" id="theme" />

    <!-- Theme used for syntax highlighted code -->
    <link
            rel="stylesheet"
            href="reveal.js/plugin/highlight/monokai.css"
            id="highlight-theme"
    />
</head>
<body>
<div class="reveal">
    <div class="slides">
        <section>
            <h2>Trunk Based Development Workshop</h2>
            <sub>By Eylon Malin</sub>
        </section>
        <section>
            <section>
                <h1>Small changes</h1>
            </section>
            <section>
                We want to merge small changes into main branch with "just enough" functionality + <b>test</b>
            </section>
            <section>
                <h3>Small changes Examples:</h3>
                <br/>
                <ul>
                    <li>method that save new user in DB</li>
                    <li>service that validate user details</li>
                    <li>HTTP POST route that create the user (only call the service method)</li>
                </ul>
            </section>
            <section>
                <h3>Big change Example</h3>
                <br/>
                <p>Create new POST route that create the user,
                    <br>including all needed code in:
                    <ul>
                        <li>http level (controller)</li>
                        <li>service level</li>
                        <li>DAL level</li>
                    </ul>
                </p>
            </section>
            <section>
                <h3>Small changes advantages</h3>
                <br/>
                <ul>
                    <li>Early feedback</li>
                    <li>quick and efficient code review</li>
                    <li>Early code merge</li>
                    <li>Easy merges</li>
                </ul>
            </section>
            <section>
                <h3>Test come along with functionality</h3>
                <br/>
                <ul>
                    <li>For any such small change we merge it's test as part of the changeset (Pull Request)</li>
                    <li>Sometimes the test is just unit test/s and sometimes it include component or even end-to-end tests</li>
                </ul>
            </section>
            <section>
                <h3>Test First Development</h3>
                <h4>Write the tests before you write the code.</h4>
                <br/>
                <ul><h5>Some advantages:</h5>
                    <li>Test is already there when functionality is done</li>
                    <li>Making sure test really test something<br>(failed when functionality is missing)</li>
                    <li>Declare method signature/API before coding it</li>
                    <li>Enabler for refactor</li>
                </ul>
            </section>
            <section>
                <h3>Top down / Bottom up</h3>
                <img src="./assets/top_down_bottom_up.jpg">
            </section>
        </section>
        <section>
            <section>
                <h3>Exercise 1 - small changes</h3>
                <ul>
                    <li><a href="https://github.com/eylonmalin/trunk-base-workshop/fork">fork trunk-base-workshop git</a></li>
                    <li>Checkout branch lesson1/exercise-1-start</li>
                    <li>Change the code so by default the user will get forecast of his current location</li>
                    <li><b>Commit and push little changes covered by tests</b></li>
                    <li>Choose strategy: <i style="font-style: italic !important">top-down</i> or <i style="font-style: italic !important">bottom-up</i></li>
                </ul>
            </section>
            <section>
                <h3>Exercise 1 - some tips</h3>
                <ul>
                    <li>Use openweathermap API for <a href="https://openweathermap.org/current#geo">weather</a> and
                    <a href="https://openweathermap.org/forecast5#geo5">forecast</a>
                    </li>
                    <li>You might use the following frontend code for getting the user location:
                        <pre><code data-trim data-noesacpe>
function getCurrentLocation() {
  return new Promise(function(resolve, reject) {
    navigator.geolocation.getCurrentPosition(resolve, reject);
  });
}
                    </code></pre>
                    </li>
                </ul>
            </section>
        </section>
        <section>
            <section>
                <h1>Branch By Abstraction</h1>
            </section>
            <section>
                <h3>Branch By Abstraction description</h3>
                <p>
                    "Branch by Abstraction" is a technique for making a large-scale change to a software system in
                    gradual way that allows you to release the system regularly while the change is still in-progress.
                </p>
                <a href="https://martinfowler.com/bliki/BranchByAbstraction.html">Martin Fowler</a>
            </section>
            <section>
                <h3>Branch By Abstraction step by step</h3>
                <ul>
                    <li>There is a piece of code you want to change, the code is consumed elsewhere in your system</li>
                    <li>Create an abstraction of this code (e.g. extract an interface)</li>
                    <li>Make the consumers of this code to consume the abstraction instead of concrete implementation</li>
                    <li>Create the change you want to make as another implementation (supplier). Implement it in small steps</li>
                </ul>
            </section>
            <section>
                <h3>Branch By Abstraction step by step - cont</h3>
                <ul>
                    <li>Once the new implementation is ready switch the system to use it (or use feature toggle)</li>
                    <li>Clean leftover while needed (like removed previous implementation)</li>
                </ul>
                <p>
                    <a href="https://martinfowler.com/bliki/BranchByAbstraction.html">Illustration by Martin Fowler</a>
                </p>
            </section>
            <section>
                <a href="https://codecoolture.com/blog/branch-by-abstraction-react/">React Example</a>
            </section>
            <section>
                <a href="https://github.com/eylonmalin/trunk-base-workshop/commits/lesson2/nestjs-abstraction">NestJs Example</a>
            </section>
        </section>
        <section>
            <section>
                <h3>Exercise 2 - react branch by abstraction</h3>
                <ul>
                    <li>Checkout branch lesson2/exercise-2-start</li>
                    <li>Change the code so instead of weather icon user will see emojis icons</li>
                    <li>use <a href="https://emoji-css.afeld.me/">emoji-css.afeld.me</a>  for that</li>
                    <li>merge small changes by using branch by abstraction</li>
                </ul>
            </section>
        </section>
    </div>
</div>

<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/markdown/markdown.js"></script>
<script src="./reveal.js/plugin/highlight/highlight.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script>
    // More info about initialization & config:
    // - https://revealjs.com/initialization/
    // - https://revealjs.com/config/
    Reveal.initialize({
        hash: true,

        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [RevealMarkdown, RevealHighlight, RevealNotes, RevealZoom],
    });
</script>
</body>
</html>
